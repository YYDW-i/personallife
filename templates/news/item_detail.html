{% extends "base.html" %}
{% load static %}
{% block title %}{{ item.title|truncatechars:40 }} Â· News Â· LocalLife{% endblock %}

{% block content %}
<section class="glass card">
  <div class="cal-head">
    <div>
      <div class="card-title">{{ item.title }}</div>
      <div class="card-subtitle">
        {% if item.source %}{{ item.source.name }} Â· {% endif %}
        {{ item.published_at|date:"Y-m-d H:i" }}
        {% if item.item_type == "PAPER" %} Â· Paper{% else %} Â· News{% endif %}
      </div>
    </div>

    <div class="cal-actions">
      <a class="btn subtle" href="{% url 'news:home' %}">å›åˆ°ä»Šæ—¥</a>
      <a class="btn subtle" href="{{ item.url }}" target="_blank" rel="noreferrer">æ‰“å¼€åŸæ–‡</a>
    </div>
  </div>

  <div class="item-meta">
    {% if item.item_type == "PAPER" %}
      {% if item.authors and item.authors|length %}
        <div><span class="muted">ä½œè€…ï¼š</span>{{ item.authors|join:", " }}</div>
      {% endif %}
      {% if item.venue %}<div><span class="muted">æœŸåˆŠ/å¹³å°ï¼š</span>{{ item.venue }}</div>{% endif %}
      {% if item.year %}<div><span class="muted">å¹´ä»½ï¼š</span>{{ item.year }}</div>{% endif %}
      {% if item.doi %}<div><span class="muted">DOIï¼š</span>{{ item.doi }}</div>{% endif %}
    {% else %}
      {% if item.language %}<div><span class="muted">è¯­è¨€ï¼š</span>{{ item.language }}</div>{% endif %}
      {% if item.region %}<div><span class="muted">åœ°åŒºï¼š</span>{{ item.region }}</div>{% endif %}
    {% endif %}
  </div>

  {% if item.summary %}
    <div class="item-summary">
      {{ item.summary|linebreaksbr }}
    </div>
  {% else %}
    <div class="muted">æš‚æ— æ‘˜è¦ã€‚</div>
  {% endif %}

  <div class="news-actions" style="margin-top:14px;">
    <button
      class="btn subtle js-toggle {% if state.is_read %}active{% endif %}"
      data-news-toggle="1"
      data-url="{% url 'news:toggle_item_state' item.id %}"
      data-field="is_read"
      data-on-text="å·²è¯» âœ“"
      data-off-text="æ ‡è®°å·²è¯»">
      {% if state.is_read %}å·²è¯» âœ“{% else %}æ ‡è®°å·²è¯»{% endif %}
    </button>

    <button
      class="btn subtle js-toggle {% if state.is_favorite %}active{% endif %}"
      data-news-toggle="1"
      data-url="{% url 'news:toggle_item_state' item.id %}"
      data-field="is_favorite"
      data-on-text="å·²æ”¶è— â˜…"
      data-off-text="æ”¶è—">
      {% if state.is_favorite %}å·²æ”¶è— â˜…{% else %}æ”¶è—{% endif %}
    </button>

    <button
      class="btn subtle js-toggle {% if state.is_later %}active{% endif %}"
      data-news-toggle="1"
      data-url="{% url 'news:toggle_item_state' item.id %}"
      data-field="is_later"
      data-on-text="ç¨åè¯» â³"
      data-off-text="ç¨åè¯»">
      {% if state.is_later %}ç¨åè¯» â³{% else %}ç¨åè¯»{% endif %}
    </button>

    <button
      class="btn danger js-toggle {% if state.is_blocked %}active{% endif %}"
      data-news-toggle="1"
      data-url="{% url 'news:toggle_item_state' item.id %}"
      data-field="is_blocked"
      data-on-text="å·²å±è”½ ğŸš«"
      data-off-text="å±è”½">
      {% if state.is_blocked %}å·²å±è”½ ğŸš«{% else %}å±è”½{% endif %}
    </button>
  </div>
</section>

<script src="{% static 'news/news.js' %}"></script>
{% endblock %}
